<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Parsimony tree. — fitch • phangorn</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parsimony tree. — fitch"><meta name="description" content="pratchet implements the parsimony ratchet (Nixon, 1999) and is the
preferred way to search for the best parsimony tree. For small number of taxa
the function bab can be used to compute all most parsimonious
trees."><meta property="og:description" content="pratchet implements the parsimony ratchet (Nixon, 1999) and is the
preferred way to search for the best parsimony tree. For small number of taxa
the function bab can be used to compute all most parsimonious
trees."><meta property="og:image" content="https://klausvigo.github.io/phangorn/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">phangorn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.12.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Trees.html">Estimating phylogenetic trees with phangorn</a></li>
    <li><a class="dropdown-item" href="../articles/Morphological.html">Phylogenetic trees from morphological data</a></li>
    <li><a class="dropdown-item" href="../articles/AdvancedFeatures.html">Markov models and transition rate matrices</a></li>
    <li><a class="dropdown-item" href="../articles/Ancestral.html">Ancestral Sequence Reconstruction</a></li>
    <li><a class="dropdown-item" href="../articles/Networx.html">Splits and Networx</a></li>
    <li><a class="dropdown-item" href="../articles/MLbyHand.html">Maximum likelihood by hand</a></li>
    <li><a class="dropdown-item" href="../articles/IntertwiningTreesAndNetworks.html">Intertwining phylogenetic trees and networks: R Example Script</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/KlausVigo/phangorn/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Parsimony tree.</h1>
      <small class="dont-index">Source: <a href="https://github.com/KlausVigo/phangorn/blob/master/R/fitch64.R" class="external-link"><code>R/fitch64.R</code></a>, <a href="https://github.com/KlausVigo/phangorn/blob/master/R/parsimony.R" class="external-link"><code>R/parsimony.R</code></a>, <a href="https://github.com/KlausVigo/phangorn/blob/master/R/sankoff.R" class="external-link"><code>R/sankoff.R</code></a></small>
      <div class="d-none name"><code>parsimony.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>pratchet</code> implements the parsimony ratchet (Nixon, 1999) and is the
preferred way to search for the best parsimony tree. For small number of taxa
the function <code><a href="bab.html">bab</a></code> can be used to compute all most parsimonious
trees.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fitch</span><span class="op">(</span><span class="va">tree</span>, <span class="va">data</span>, site <span class="op">=</span> <span class="st">"pscore"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">random.addition</span><span class="op">(</span><span class="va">data</span>, tree <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="st">"fitch"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">parsimony</span><span class="op">(</span><span class="va">tree</span>, <span class="va">data</span>, method <span class="op">=</span> <span class="st">"fitch"</span>, cost <span class="op">=</span> <span class="cn">NULL</span>, site <span class="op">=</span> <span class="st">"pscore"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">optim.parsimony</span><span class="op">(</span><span class="va">tree</span>, <span class="va">data</span>, method <span class="op">=</span> <span class="st">"fitch"</span>, cost <span class="op">=</span> <span class="cn">NULL</span>, trace <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  rearrangements <span class="op">=</span> <span class="st">"SPR"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pratchet</span><span class="op">(</span><span class="va">data</span>, start <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="st">"fitch"</span>, maxit <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  minit <span class="op">=</span> <span class="fl">100</span>, k <span class="op">=</span> <span class="fl">10</span>, trace <span class="op">=</span> <span class="fl">1</span>, all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rearrangements <span class="op">=</span> <span class="st">"SPR"</span>, perturbation <span class="op">=</span> <span class="st">"ratchet"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sankoff</span><span class="op">(</span><span class="va">tree</span>, <span class="va">data</span>, cost <span class="op">=</span> <span class="cn">NULL</span>, site <span class="op">=</span> <span class="st">"pscore"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tree">tree<a class="anchor" aria-label="anchor" href="#arg-tree"></a></dt>
<dd><p>tree to start the nni search from.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A object of class phyDat containing sequences.</p></dd>


<dt id="arg-site">site<a class="anchor" aria-label="anchor" href="#arg-site"></a></dt>
<dd><p>return either 'pscore' or 'site' wise parsimony scores.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>one of 'fitch' or 'sankoff'.</p></dd>


<dt id="arg-cost">cost<a class="anchor" aria-label="anchor" href="#arg-cost"></a></dt>
<dd><p>A cost matrix for the transitions between two states.</p></dd>


<dt id="arg-trace">trace<a class="anchor" aria-label="anchor" href="#arg-trace"></a></dt>
<dd><p>defines how much information is printed during optimization.</p></dd>


<dt id="arg-rearrangements">rearrangements<a class="anchor" aria-label="anchor" href="#arg-rearrangements"></a></dt>
<dd><p>SPR or NNI rearrangements.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to or from other methods (e.g.
model="sankoff" and cost matrix).</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>a starting tree can be supplied.</p></dd>


<dt id="arg-maxit">maxit<a class="anchor" aria-label="anchor" href="#arg-maxit"></a></dt>
<dd><p>maximum number of iterations in the ratchet.</p></dd>


<dt id="arg-minit">minit<a class="anchor" aria-label="anchor" href="#arg-minit"></a></dt>
<dd><p>minimum number of iterations in the ratchet.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>number of rounds ratchet is stopped, when there is no improvement.</p></dd>


<dt id="arg-all">all<a class="anchor" aria-label="anchor" href="#arg-all"></a></dt>
<dd><p>return all equally good trees or just one of them.</p></dd>


<dt id="arg-perturbation">perturbation<a class="anchor" aria-label="anchor" href="#arg-perturbation"></a></dt>
<dd><p>whether to use "ratchet", "random_addition" or
"stochastic" (nni) for shuffling the tree.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>parsimony</code> returns the maximum parsimony score (pscore).
<code>optim.parsimony</code> returns a tree after NNI rearrangements.
<code>pratchet</code> returns a tree or list of trees containing the best tree(s)
found during the search.  <code>acctran</code> returns a tree with edge length
according to the ACCTRAN criterion.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>parsimony</code> returns the parsimony score of a tree using either the
sankoff or the fitch algorithm.
<code>optim.parsimony</code> optimizes the topology using either Nearest Neighbor
Interchange (NNI) rearrangements or sub tree pruning and regrafting (SPR) and
is used inside <code>pratchet</code>. <code>random.addition</code> can be used to produce
starting trees and is an option for the argument perturbation in
<code>pratchet</code>.</p>
<p>The "SPR" rearrangements are so far only available for the "fitch" method,
"sankoff" only uses "NNI". The "fitch" algorithm only works correct for
binary trees.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Felsenstein, J. (2004). <em>Inferring Phylogenies</em>. Sinauer
Associates, Sunderland.</p>
<p>Nixon, K. (1999) The Parsimony Ratchet, a New Method for Rapid Parsimony
Analysis. <em>Cladistics</em> <b>15</b>, 407-414</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="bab.html">bab</a></code>, <code><a href="CI.html">CI</a></code>, <code><a href="CI.html">RI</a></code>,
<code><a href="acctran.html">acctran</a></code>, <code><a href="nni.html">nni</a></code>, <code><a href="NJ.html">NJ</a></code>,
<code><a href="pml.html">pml</a></code>, <code><a href="getClans.html">getClans</a></code>, <code><a href="ancestral.pml.html">ancestral.pars</a></code>,
<code><a href="bootstrap.pml.html">bootstrap.pml</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Laurasiatherian</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="dist.hamming.html">dist.hamming</a></span><span class="op">(</span><span class="va">Laurasiatherian</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="NJ.html">NJ</a></span><span class="op">(</span><span class="va">dm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">parsimony</span><span class="op">(</span><span class="va">tree</span>, <span class="va">Laurasiatherian</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9796</span>
<span class="r-in"><span><span class="va">treeRA</span> <span class="op">&lt;-</span> <span class="fu">random.addition</span><span class="op">(</span><span class="va">Laurasiatherian</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">treeSPR</span> <span class="op">&lt;-</span> <span class="fu">optim.parsimony</span><span class="op">(</span><span class="va">tree</span>, <span class="va">Laurasiatherian</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Final p-score 9715 after  11 nni operations </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># lower number of iterations for the example (to run less than 5 seconds),</span></span></span>
<span class="r-in"><span><span class="co"># keep default values (maxit, minit, k) or increase them for real life</span></span></span>
<span class="r-in"><span><span class="co"># analyses.</span></span></span>
<span class="r-in"><span><span class="va">treeRatchet</span> <span class="op">&lt;-</span> <span class="fu">pratchet</span><span class="op">(</span><span class="va">Laurasiatherian</span>, start<span class="op">=</span><span class="va">tree</span>, maxit<span class="op">=</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>                        minit<span class="op">=</span><span class="fl">5</span>, k<span class="op">=</span><span class="fl">5</span>, trace<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># assign edge length (number of substitutions)</span></span></span>
<span class="r-in"><span><span class="va">treeRatchet</span> <span class="op">&lt;-</span> <span class="fu"><a href="acctran.html">acctran</a></span><span class="op">(</span><span class="va">treeRatchet</span>, <span class="va">Laurasiatherian</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># remove edges of length 0</span></span></span>
<span class="r-in"><span><span class="va">treeRatchet</span> <span class="op">&lt;-</span> <span class="fu">di2multi</span><span class="op">(</span><span class="va">treeRatchet</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="midpoint.html">midpoint</a></span><span class="op">(</span><span class="va">treeRatchet</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">add.scale.bar</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>, length<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="parsimony-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">parsimony</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tree</span>,<span class="va">treeSPR</span>, <span class="va">treeRatchet</span><span class="op">)</span>, <span class="va">Laurasiatherian</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9796 9715 9713</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Klaus Schliep, Emmanuel Paradis, Leonardo de Oliveira Martins, Alastair Potts, Iris Bardel-Kahr.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

