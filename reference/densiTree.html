<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plots a densiTree. — densiTree • phangorn</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plots a densiTree. — densiTree"><meta name="description" content="An R function to plot trees similar to those produced by DensiTree."><meta property="og:description" content="An R function to plot trees similar to those produced by DensiTree."><meta property="og:image" content="https://klausvigo.github.io/phangorn/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">phangorn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.12.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Trees.html">Estimating phylogenetic trees with phangorn</a></li>
    <li><a class="dropdown-item" href="../articles/Morphological.html">Phylogenetic trees from morphological data</a></li>
    <li><a class="dropdown-item" href="../articles/AdvancedFeatures.html">Markov models and transition rate matrices</a></li>
    <li><a class="dropdown-item" href="../articles/Ancestral.html">Ancestral Sequence Reconstruction</a></li>
    <li><a class="dropdown-item" href="../articles/Networx.html">Splits and Networx</a></li>
    <li><a class="dropdown-item" href="../articles/MLbyHand.html">Maximum likelihood by hand</a></li>
    <li><a class="dropdown-item" href="../articles/IntertwiningTreesAndNetworks.html">Intertwining phylogenetic trees and networks: R Example Script</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/KlausVigo/phangorn/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plots a densiTree.</h1>
      <small class="dont-index">Source: <a href="https://github.com/KlausVigo/phangorn/blob/main/R/Densi.R" class="external-link"><code>R/Densi.R</code></a></small>
      <div class="d-none name"><code>densiTree.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>An R function to plot trees similar to those produced by DensiTree.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">densiTree</span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">"phylogram"</span>, <span class="va">...</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  consensus <span class="op">=</span> <span class="cn">NULL</span>, direction <span class="op">=</span> <span class="st">"rightwards"</span>, optim <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scaleX <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, font <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  tip.color <span class="op">=</span> <span class="fl">1</span>, adj <span class="op">=</span> <span class="fl">0</span>, srt <span class="op">=</span> <span class="fl">0</span>, underscore <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  label.offset <span class="op">=</span> <span class="fl">0</span>, scale.bar <span class="op">=</span> <span class="cn">TRUE</span>, jitter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>amount <span class="op">=</span> <span class="fl">0</span>, random <span class="op">=</span></span>
<span>  <span class="cn">TRUE</span><span class="op">)</span>, tip.dates <span class="op">=</span> <span class="cn">NULL</span>, xlim <span class="op">=</span> <span class="cn">NULL</span>, ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show.consensus <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an object of class <code>multiPhylo</code>.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>a character string specifying the type of phylogeny, so far
"cladogram" (default) or "phylogram" are supported.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments to be passed to plot.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>parameter for semi-transparent colors.</p></dd>


<dt id="arg-consensus">consensus<a class="anchor" aria-label="anchor" href="#arg-consensus"></a></dt>
<dd><p>A tree or character vector which is used to define the order
of the tip labels.</p></dd>


<dt id="arg-direction">direction<a class="anchor" aria-label="anchor" href="#arg-direction"></a></dt>
<dd><p>a character string specifying the direction of the tree.
Four values are possible: "rightwards" (the default), "leftwards", "upwards",
and "downwards".</p></dd>


<dt id="arg-optim">optim<a class="anchor" aria-label="anchor" href="#arg-optim"></a></dt>
<dd><p>not yet used.</p></dd>


<dt id="arg-scalex">scaleX<a class="anchor" aria-label="anchor" href="#arg-scalex"></a></dt>
<dd><p>scale trees to have identical heights.</p></dd>


<dt id="arg-col">col<a class="anchor" aria-label="anchor" href="#arg-col"></a></dt>
<dd><p>a scalar or vector giving the colours used to draw the edges for
each plotted phylogeny. These are taken to be in the same order than input
trees x. If fewer colours are given than the number of trees, then the
colours are recycled.</p></dd>


<dt id="arg-width">width<a class="anchor" aria-label="anchor" href="#arg-width"></a></dt>
<dd><p>edge width.</p></dd>


<dt id="arg-lty">lty<a class="anchor" aria-label="anchor" href="#arg-lty"></a></dt>
<dd><p>line type.</p></dd>


<dt id="arg-cex">cex<a class="anchor" aria-label="anchor" href="#arg-cex"></a></dt>
<dd><p>a numeric value giving the factor scaling of the tip labels.</p></dd>


<dt id="arg-font">font<a class="anchor" aria-label="anchor" href="#arg-font"></a></dt>
<dd><p>an integer specifying the type of font for the labels:
1 (plain text), 2 (bold), 3 (italic, the default), or 4 (bold italic).</p></dd>


<dt id="arg-tip-color">tip.color<a class="anchor" aria-label="anchor" href="#arg-tip-color"></a></dt>
<dd><p>color of the tip labels.</p></dd>


<dt id="arg-adj">adj<a class="anchor" aria-label="anchor" href="#arg-adj"></a></dt>
<dd><p>a numeric specifying the justification of the text strings of the
labels: 0 (left-justification), 0.5 (centering), or 1 (right-justification).</p></dd>


<dt id="arg-srt">srt<a class="anchor" aria-label="anchor" href="#arg-srt"></a></dt>
<dd><p>a numeric giving how much the labels are rotated in degrees.</p></dd>


<dt id="arg-underscore">underscore<a class="anchor" aria-label="anchor" href="#arg-underscore"></a></dt>
<dd><p>a logical specifying whether the underscores in tip labels
should be written as spaces (the default) or left as are (if TRUE).</p></dd>


<dt id="arg-label-offset">label.offset<a class="anchor" aria-label="anchor" href="#arg-label-offset"></a></dt>
<dd><p>a numeric giving the space between the nodes and the tips
of the phylogeny and their corresponding labels.</p></dd>


<dt id="arg-scale-bar">scale.bar<a class="anchor" aria-label="anchor" href="#arg-scale-bar"></a></dt>
<dd><p>a logical specifying whether add scale.bar to the plot.</p></dd>


<dt id="arg-jitter">jitter<a class="anchor" aria-label="anchor" href="#arg-jitter"></a></dt>
<dd><p>allows to shift trees. a list with two arguments: the amount of
jitter and random or equally spaced (see details below)</p></dd>


<dt id="arg-tip-dates">tip.dates<a class="anchor" aria-label="anchor" href="#arg-tip-dates"></a></dt>
<dd><p>A named vector of sampling times associated with the tips.</p></dd>


<dt id="arg-xlim">xlim<a class="anchor" aria-label="anchor" href="#arg-xlim"></a></dt>
<dd><p>the x limits of the plot.</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>the y limits of the plot.</p></dd>


<dt id="arg-show-consensus">show.consensus<a class="anchor" aria-label="anchor" href="#arg-show-consensus"></a></dt>
<dd><p>superimpose the consensus tree?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>densiTree</code> returns silently x.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If no consensus tree is provided <code>densiTree</code> computes a consensus tree,
and if the input trees have different labels a mrp.supertree as a backbone.
This should avoid too many unnecessary crossings of edges.
Trees should be rooted, other wise the output may not be visually pleasing.
<code>jitter</code> shifts trees a bit so that they are not exactly on top of each
other.
If <code>amount == 0</code>, it is ignored. If <code>random=TRUE</code> the result of the
permutation is <code>runif(n, -amount, amount)</code>, otherwise
<code>seq(-amount, amount, length=n)</code>, where <code>n &lt;- length(x)</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>densiTree is inspired from the great
<a href="https://www.cs.auckland.ac.nz/~remco/DensiTree/" class="external-link">DensiTree</a> program of
Remco Bouckaert.</p>
<p>Remco R. Bouckaert (2010) DensiTree: making sense of sets of phylogenetic
trees <em>Bioinformatics</em>, <b>26 (10)</b>, 1372-1373.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">plot.phylo</a></code>, <code><a href="plot.networx.html">plot.networx</a></code>,
<code><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></code>, <code><a href="https://rdrr.io/pkg/ape/man/rtt.html" class="external-link">rtt</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Laurasiatherian</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bs</span> <span class="op">&lt;-</span> <span class="fu"><a href="bootstrap.pml.html">bootstrap.phyDat</a></span><span class="op">(</span><span class="va">Laurasiatherian</span>, FUN <span class="op">=</span></span></span>
<span class="r-in"><span>   <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="upgma.html">upgma</a></span><span class="op">(</span><span class="fu"><a href="dist.hamming.html">dist.hamming</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, bs<span class="op">=</span><span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># cladogram nice to show topological differences</span></span></span>
<span class="r-in"><span><span class="fu">densiTree</span><span class="op">(</span><span class="va">bs</span>, type<span class="op">=</span><span class="st">"cladogram"</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="densiTree-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">densiTree</span><span class="op">(</span><span class="va">bs</span>, type<span class="op">=</span><span class="st">"phylogram"</span>, col<span class="op">=</span><span class="st">"green"</span>, direction<span class="op">=</span><span class="st">"downwards"</span>, width<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="densiTree-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># show consensus tree</span></span></span>
<span class="r-in"><span><span class="va">tree_compat</span> <span class="op">&lt;-</span> <span class="fu"><a href="maxCladeCred.html">allCompat</a></span><span class="op">(</span><span class="va">bs</span>, rooted<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="add_edge_length.html">add_edge_length</a></span><span class="op">(</span><span class="va">bs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">densiTree</span><span class="op">(</span><span class="va">bs</span>, type<span class="op">=</span><span class="st">"phylogram"</span>, col<span class="op">=</span><span class="st">"green"</span>, consensus <span class="op">=</span> <span class="va">tree_compat</span>,</span></span>
<span class="r-in"><span>  show.consensus<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="densiTree-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot five trees slightly shifted, no transparent color</span></span></span>
<span class="r-in"><span><span class="fu">densiTree</span><span class="op">(</span><span class="va">bs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"phylogram"</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, width<span class="op">=</span><span class="fl">2</span>, jitter<span class="op">=</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>amount<span class="op">=</span><span class="fl">.3</span>, random<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="densiTree-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># phylograms are nice to show different age estimates</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">PhyloOrchard</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">BinindaEmondsEtAl2007</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">BinindaEmondsEtAl2007</span> <span class="op">&lt;-</span> <span class="fu">.compressTipLabel</span><span class="op">(</span><span class="va">BinindaEmondsEtAl2007</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">densiTree</span><span class="op">(</span><span class="va">BinindaEmondsEtAl2007</span>, type<span class="op">=</span><span class="st">"phylogram"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Klaus Schliep, Emmanuel Paradis, Leonardo de Oliveira Martins, Alastair Potts, Iris Bardel-Kahr.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

