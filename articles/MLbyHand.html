<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Maximum likelihood by hand • phangorn</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maximum likelihood by hand">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">phangorn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.12.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Trees.html">Estimating phylogenetic trees with phangorn</a></li>
    <li><a class="dropdown-item" href="../articles/Morphological.html">Phylogenetic trees from morphological data</a></li>
    <li><a class="dropdown-item" href="../articles/AdvancedFeatures.html">Markov models and transition rate matrices</a></li>
    <li><a class="dropdown-item" href="../articles/Ancestral.html">Ancestral Sequence Reconstruction</a></li>
    <li><a class="dropdown-item" href="../articles/Networx.html">Splits and Networx</a></li>
    <li><a class="dropdown-item" href="../articles/MLbyHand.html">Maximum likelihood by hand</a></li>
    <li><a class="dropdown-item" href="../articles/IntertwiningTreesAndNetworks.html">Intertwining phylogenetic trees and networks: R Example Script</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/KlausVigo/phangorn/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Maximum likelihood by hand</h1>
                        <h4 data-toc-skip class="author">Klaus Schliep,
Iris Bardel-Kahr</h4>
            <address class="author_afil">
      Graz University of Technology, University of
Graz<br><a class="author_email" href="mailto:#"></a><a href="mailto:klaus.schliep@gmail.com" class="email">klaus.schliep@gmail.com</a>
      </address>
                  
            <h4 data-toc-skip class="date">2025-06-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/KlausVigo/phangorn/blob/master/vignettes/MLbyHand.Rmd" class="external-link"><code>vignettes/MLbyHand.Rmd</code></a></small>
      <div class="d-none name"><code>MLbyHand.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="maximum-likelihood-by-hand">Maximum likelihood by hand<a class="anchor" aria-label="anchor" href="#maximum-likelihood-by-hand"></a>
</h2>
<p>With the function <code>pml_bb</code> from <em>phangorn</em> <span class="citation">(Schliep 2011)</span> a lot of steps have become easier
and shorter. If you want to have more control over all of the used
parameters, it is also possible to use the older functions,
e.g. <code>optim_pml</code>. The data is the same as in the vignette
<em>Estimating phylogenetic trees with phangorn</em>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emmanuelparadis/ape" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/KlausVigo/phangorn" class="external-link">phangorn</a></span><span class="op">)</span></span>
<span><span class="va">fdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/trees"</span>, package <span class="op">=</span> <span class="st">"phangorn"</span><span class="op">)</span></span>
<span><span class="va">primates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read.phyDat.html">read.phyDat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">fdir</span>, <span class="st">"primates.dna"</span><span class="op">)</span>,</span>
<span>                        format <span class="op">=</span> <span class="st">"interleaved"</span><span class="op">)</span></span></code></pre></div>
<p>As a starting tree, we calculate a neighbor joining tree:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dist.hamming.html">dist.ml</a></span><span class="op">(</span><span class="va">primates</span><span class="op">)</span></span>
<span><span class="va">treeNJ</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NJ.html">NJ</a></span><span class="op">(</span><span class="va">dm</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pml.html">pml</a></span><span class="op">(</span><span class="va">treeNJ</span>, data<span class="op">=</span><span class="va">primates</span><span class="op">)</span></span>
<span><span class="va">fit</span></span></code></pre></div>
<pre><code><span><span class="co">## model: JC </span></span>
<span><span class="co">## loglikelihood: -3075 </span></span>
<span><span class="co">## unconstrained loglikelihood: -1230 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Rate matrix:</span></span>
<span><span class="co">##   a c g t</span></span>
<span><span class="co">## a 0 1 1 1</span></span>
<span><span class="co">## c 1 0 1 1</span></span>
<span><span class="co">## g 1 1 0 1</span></span>
<span><span class="co">## t 1 1 1 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Base frequencies:  </span></span>
<span><span class="co">##    a    c    g    t </span></span>
<span><span class="co">## 0.25 0.25 0.25 0.25</span></span></code></pre>
<p>The function <code>pml</code> returns an object of class
<code>pml</code>. This object contains the data, the tree and many
different parameters of the model like the likelihood. There are many
generic functions for the class <code>pml</code> available, which allow
the handling of these objects.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class<span class="op">=</span><span class="st">"pml"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] AICc   anova  BIC    glance logLik plot   print  simSeq update vcov  </span></span>
<span><span class="co">## see '?methods' for accessing help and source code</span></span></code></pre>
<p>The object fit just estimated the likelihood for the tree it got
supplied, but the branch length are not optimized for the Jukes-Cantor
<span class="citation">(Jukes and Cantor 1969)</span> model yet, which
can be done with the function <code>optim.pml</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitJC</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pml.html">optim.pml</a></span><span class="op">(</span><span class="va">fit</span>, rearrangement<span class="op">=</span><span class="st">"NNI"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## optimize edge weights:  -3075 --&gt; -3068 </span></span>
<span><span class="co">## optimize edge weights:  -3068 --&gt; -3068 </span></span>
<span><span class="co">## optimize topology:  -3068 --&gt; -3068  NNI moves:  1 </span></span>
<span><span class="co">## optimize edge weights:  -3068 --&gt; -3068 </span></span>
<span><span class="co">## optimize topology:  -3068 --&gt; -3068  NNI moves:  0</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">fitJC</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'log Lik.' -3068 (df=25)</span></span></code></pre>
<p>With the default values <code>pml</code> will estimate a Jukes-Cantor
model. That means equal base frequencies and all transition rates are
equal. The generic function <code>update</code> allows to change
parameters manually. This is not what we usually want to do. However we
might want to supply a different tree or change the number of rate
categories.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitF81</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fitJC</span>, k<span class="op">=</span><span class="fl">4</span>, inv<span class="op">=</span><span class="fl">0.2</span>, bf<span class="op">=</span><span class="fu"><a href="../reference/baseFreq.html">baseFreq</a></span><span class="op">(</span><span class="va">primates</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fitF81</span></span></code></pre></div>
<pre><code><span><span class="co">## model: F81+G(4)+I </span></span>
<span><span class="co">## loglikelihood: -3037 </span></span>
<span><span class="co">## unconstrained loglikelihood: -1230 </span></span>
<span><span class="co">## Proportion of invariant sites: 0.2 </span></span>
<span><span class="co">## Model of rate heterogeneity: Discrete gamma model</span></span>
<span><span class="co">## Number of rate categories: 4 </span></span>
<span><span class="co">## Shape parameter: 1 </span></span>
<span><span class="co">##     Rate Proportion</span></span>
<span><span class="co">## 1 0.0000        0.2</span></span>
<span><span class="co">## 2 0.1712        0.2</span></span>
<span><span class="co">## 3 0.5959        0.2</span></span>
<span><span class="co">## 4 1.2500        0.2</span></span>
<span><span class="co">## 5 2.9829        0.2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Rate matrix:</span></span>
<span><span class="co">##   a c g t</span></span>
<span><span class="co">## a 0 1 1 1</span></span>
<span><span class="co">## c 1 0 1 1</span></span>
<span><span class="co">## g 1 1 0 1</span></span>
<span><span class="co">## t 1 1 1 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Base frequencies:  </span></span>
<span><span class="co">##       a       c       g       t </span></span>
<span><span class="co">## 0.37481 0.40160 0.03911 0.18448</span></span></code></pre>
<p>In the line above we changed the model to a (discrete) rate across
site model with 4 rate categories (using the default shape parameter of
1), to 0.2 invariant sites and supply empirical base frequencies.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitGTR</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pml.html">optim.pml</a></span><span class="op">(</span><span class="va">fitF81</span>, model<span class="op">=</span><span class="st">"GTR"</span>, optInv<span class="op">=</span><span class="cn">TRUE</span>, optGamma<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>    rearrangement <span class="op">=</span> <span class="st">"NNI"</span>, control <span class="op">=</span> <span class="fu"><a href="../reference/pml.control.html">pml.control</a></span><span class="op">(</span>trace <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fitGTR</span></span></code></pre></div>
<pre><code><span><span class="co">## model: GTR+G(4)+I </span></span>
<span><span class="co">## loglikelihood: -2611 </span></span>
<span><span class="co">## unconstrained loglikelihood: -1230 </span></span>
<span><span class="co">## Proportion of invariant sites: 0.006978 </span></span>
<span><span class="co">## Model of rate heterogeneity: Discrete gamma model</span></span>
<span><span class="co">## Number of rate categories: 4 </span></span>
<span><span class="co">## Shape parameter: 3.081 </span></span>
<span><span class="co">##     Rate Proportion</span></span>
<span><span class="co">## 1 0.0000   0.006978</span></span>
<span><span class="co">## 2 0.3982   0.248256</span></span>
<span><span class="co">## 3 0.7411   0.248256</span></span>
<span><span class="co">## 4 1.0905   0.248256</span></span>
<span><span class="co">## 5 1.7982   0.248256</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Rate matrix:</span></span>
<span><span class="co">##         a         c         g      t</span></span>
<span><span class="co">## a  0.0000  0.947235 63.592883  0.807</span></span>
<span><span class="co">## c  0.9472  0.000000  0.003986 24.635</span></span>
<span><span class="co">## g 63.5929  0.003986  0.000000  1.000</span></span>
<span><span class="co">## t  0.8070 24.634579  1.000000  0.000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Base frequencies:  </span></span>
<span><span class="co">##       a       c       g       t </span></span>
<span><span class="co">## 0.37481 0.40160 0.03911 0.18448</span></span></code></pre>
<p>We will change the model to the GTR +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>4</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Gamma(4)</annotation></semantics></math>
+ I model and then optimize all the parameters.</p>
<p>With the control parameters the thresholds for the fitting process
can be changed. Here we want just to suppress output during the fitting
process. For larger trees the NNI rearrangements often get stuck in a
local maximum. We added two stochastic algorithms to improve topology
search. The first (set <code>rearrangement="stochastic"</code>) performs
stochastic rearrangements similar as in <span class="citation">(Nguyen
et al. 2015)</span>, which makes random NNI permutation to the tree,
which than gets optimized to escape local optima. The second option
(<code>rearrangement="ratchet"</code>) perform the likelihood ratchet
<span class="citation">(Vos 2003)</span>.</p>
<p>While these algorithms may find better trees they will also take more
time.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitGTR</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pml.html">optim.pml</a></span><span class="op">(</span><span class="va">fitGTR</span>, model<span class="op">=</span><span class="st">"GTR"</span>, optInv<span class="op">=</span><span class="cn">TRUE</span>, optGamma<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>    rearrangement <span class="op">=</span> <span class="st">"stochastic"</span>, control <span class="op">=</span> <span class="fu"><a href="../reference/pml.control.html">pml.control</a></span><span class="op">(</span>trace <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitGTR</span></span></code></pre></div>
<pre><code><span><span class="co">## model: GTR+G(4)+I </span></span>
<span><span class="co">## loglikelihood: -2608 </span></span>
<span><span class="co">## unconstrained loglikelihood: -1230 </span></span>
<span><span class="co">## Proportion of invariant sites: 0.007365 </span></span>
<span><span class="co">## Model of rate heterogeneity: Discrete gamma model</span></span>
<span><span class="co">## Number of rate categories: 4 </span></span>
<span><span class="co">## Shape parameter: 2.912 </span></span>
<span><span class="co">##     Rate Proportion</span></span>
<span><span class="co">## 1 0.0000   0.007365</span></span>
<span><span class="co">## 2 0.3852   0.248159</span></span>
<span><span class="co">## 3 0.7320   0.248159</span></span>
<span><span class="co">## 4 1.0901   0.248159</span></span>
<span><span class="co">## 5 1.8224   0.248159</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Rate matrix:</span></span>
<span><span class="co">##         a         c         g       t</span></span>
<span><span class="co">## a  0.0000  0.680633 69.341299  0.5591</span></span>
<span><span class="co">## c  0.6806  0.000000  0.003307 24.4306</span></span>
<span><span class="co">## g 69.3413  0.003307  0.000000  1.0000</span></span>
<span><span class="co">## t  0.5591 24.430638  1.000000  0.0000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Base frequencies:  </span></span>
<span><span class="co">##       a       c       g       t </span></span>
<span><span class="co">## 0.37481 0.40160 0.03911 0.18448</span></span></code></pre>
<div class="section level3">
<h3 id="model-comparison">Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h3>
<p>We can compare nested models for the JC and GTR +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>4</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Gamma(4)</annotation></semantics></math>
+ I model using likelihood ratio statistic</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fitJC</span>, <span class="va">fitGTR</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Likelihood Ratio Test Table</span></span>
<span><span class="co">##   Log lik. Df Df change Diff log lik. Pr(&gt;|Chi|)    </span></span>
<span><span class="co">## 1    -3068 25                                       </span></span>
<span><span class="co">## 2    -2608 35        10           920     &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p>with the Shimodaira-Hasegawa test</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/SH.test.html">SH.test</a></span><span class="op">(</span><span class="va">fitGTR</span>, <span class="va">fitJC</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      Trees  ln L Diff ln L p-value</span></span>
<span><span class="co">## [1,]     1 -2608       0.0  0.5061</span></span>
<span><span class="co">## [2,]     2 -3068     460.2  0.0000</span></span></code></pre>
<p>or with the AIC</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fitJC</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6187</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fitGTR</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5286</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/modelTest.html">AICc</a></span><span class="op">(</span><span class="va">fitGTR</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5299</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">fitGTR</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5407</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="bootstrap">Bootstrap<a class="anchor" aria-label="anchor" href="#bootstrap"></a>
</h3>
<p>At last we may want to apply standard bootstrap to test how well the
edges of the tree are supported. This has already been shown in the
vignette <em>Estimating phylogenetic trees with phangorn</em>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootstrap.pml.html">bootstrap.pml</a></span><span class="op">(</span><span class="va">fitJC</span>, bs<span class="op">=</span><span class="fl">100</span>, optNni<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>    control <span class="op">=</span> <span class="fu"><a href="../reference/pml.control.html">pml.control</a></span><span class="op">(</span>trace <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now we can plot the tree with the bootstrap support values on the
edges and also look at <code>consensusNet</code> to identify potential
conflict.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotBS.html">plotBS</a></span><span class="op">(</span><span class="fu"><a href="../reference/midpoint.html">midpoint</a></span><span class="op">(</span><span class="va">fitJC</span><span class="op">$</span><span class="va">tree</span><span class="op">)</span>, <span class="va">bs</span>, p <span class="op">=</span> <span class="fl">50</span>, type<span class="op">=</span><span class="st">"p"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="MLbyHand_files/figure-html/plotBS-1.png" alt="Tree with bootstrap support. Unrooted tree (midpoint rooted) with bootstrap support values." width="768"><p class="caption">
Tree with bootstrap support. Unrooted tree (midpoint rooted) with
bootstrap support values.
</p>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cnet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/consensusNet.html">consensusNet</a></span><span class="op">(</span><span class="va">bs</span>, p<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cnet</span>, show.edge.label<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="MLbyHand_files/figure-html/ConsensusNet-1.png" alt="ConsensusNet from the bootstrap sample." width="768"><p class="caption">
ConsensusNet from the bootstrap sample.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="generating-trees">Generating trees<a class="anchor" aria-label="anchor" href="#generating-trees"></a>
</h2>
<p><em>phangorn</em> has several functions to generate tree topologies,
which may are interesting for simulation studies. <code>allTrees</code>
computes all possible bifurcating tree topologies either rooted or
unrooted for up to 10 taxa. One has to keep in mind that the number of
trees is growing exponentially, use <code>howmanytrees</code> from
<em>ape</em> as a reminder.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trees</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/allTrees.html">allTrees</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">trees</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, cex<span class="op">=</span><span class="fl">1</span>, type<span class="op">=</span><span class="st">"u"</span><span class="op">)</span></span></code></pre></div>
<p><img src="MLbyHand_files/figure-html/allTrees-1.png" width="768"></p>
<p><code>nni</code> returns a list of all trees which are one nearest
neighbor interchange away.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nni.html">nni</a></span><span class="op">(</span><span class="va">trees</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 4 phylogenetic trees</span></span></code></pre>
<p><code>rNNI</code> and <code>rSPR</code> generate trees which are a
defined number of NNI (nearest neighbor interchange) or SPR (subtree
pruning and regrafting) away.</p>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<pre><code><span><span class="co">## R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] phangorn_2.12.1.3 ape_5.8-1        </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] nlme_3.1-168      cli_3.6.5         knitr_1.50        rlang_1.1.6      </span></span>
<span><span class="co">##  [5] xfun_0.52         generics_0.1.4    textshaping_1.0.1 jsonlite_2.0.0   </span></span>
<span><span class="co">##  [9] backports_1.5.0   htmltools_0.5.8.1 ragg_1.4.0        sass_0.4.10      </span></span>
<span><span class="co">## [13] rmarkdown_2.29    quadprog_1.5-8    grid_4.5.1        evaluate_1.0.3   </span></span>
<span><span class="co">## [17] jquerylib_0.1.4   fastmap_1.2.0     yaml_2.3.10       lifecycle_1.0.4  </span></span>
<span><span class="co">## [21] compiler_4.5.1    codetools_0.2-20  igraph_2.1.4      fs_1.6.6         </span></span>
<span><span class="co">## [25] pkgconfig_2.0.3   Rcpp_1.0.14       htmlwidgets_1.6.4 systemfonts_1.2.3</span></span>
<span><span class="co">## [29] lattice_0.22-7    digest_0.6.37     R6_2.6.1          parallel_4.5.1   </span></span>
<span><span class="co">## [33] magrittr_2.0.3    checkmate_2.3.2   Matrix_1.7-3      bslib_0.9.0      </span></span>
<span><span class="co">## [37] tools_4.5.1       pkgdown_2.1.3     cachem_1.1.0      desc_1.4.3</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Jukes1969" class="csl-entry">
Jukes, Thomas H., and Charles R. Cantor. 1969. <span>“{CHAPTER} 24 -
Evolution of Protein Molecules.”</span> In <em>Mammalian Protein
Metabolism</em>, edited by H. N. Munro, 21–132. Academic Press.
</div>
<div id="ref-Nguyen2015" class="csl-entry">
Nguyen, Lam-Tung, Heiko A. Schmidt, Arndt von Haeseler, and Bui Quang
Minh. 2015. <span>“IQ-TREE: A Fast and Effective Stochastic Algorithm
for Estimating Maximum-Likelihood Phylogenies.”</span> <em>Molecular
Biology and Evolution</em> 32 (1): 268–74. <a href="https://doi.org/10.1093/molbev/msu300" class="external-link">https://doi.org/10.1093/molbev/msu300</a>.
</div>
<div id="ref-Schliep2011" class="csl-entry">
Schliep, Klaus Peter. 2011. <span>“Phangorn: Phylogenetic Analysis in
<span>R</span>.”</span> <em>Bioinformatics</em> 27 (4): 592–93. <a href="https://doi.org/10.1093/bioinformatics/btq706" class="external-link">https://doi.org/10.1093/bioinformatics/btq706</a>.
</div>
<div id="ref-Vos2003" class="csl-entry">
Vos, R. A. 2003. <span>“Accelerated Likelihood Surface Exploration: The
Likelihood Ratchet.”</span> <em>Systematic Biology</em> 52 (3): 368–73.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Klaus Schliep, Emmanuel Paradis, Leonardo de Oliveira Martins, Alastair Potts, Iris Bardel-Kahr.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
